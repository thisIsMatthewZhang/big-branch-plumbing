---
import '../styles/global.css';

const currentPath = Astro.url.pathname;

function isActive(path: string): boolean {
    const normalizedCurrent = (currentPath.endsWith('/')) ? currentPath : (currentPath + '/');
    const normalizedPath = (path.endsWith('/') ? path + '/' : path + '/');
    return normalizedCurrent === normalizedPath;
}

function setActivePath(path: string): string {
    const baseClass = 'text-base md:text-[18px] font-medium font-[Golos_Text] cursor-pointer md:ml-5 py-2 md:py-0 block md:inline-block w-full md:w-auto text-center md:text-left';
    const activeColor = 'text-red-800';
    const inactiveColor = 'text-zinc-700 hover:text-red-800';

    return isActive(path) ? baseClass + activeColor : baseClass + inactiveColor;
}

---

<!-- Mobile: Hamburger button only (logo is in CompanyHeader) -->
<button id="mobile-menu-btn" class="md:hidden p-1.5 text-zinc-700 hover:text-red-800 ml-auto" aria-label="Toggle menu">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18" />
    </svg>
</button>

<!-- Desktop Navigation -->
<div class="hidden md:flex justify-start justify-self-end m-4 items-center">
    <a id="home" href="/" class=`${setActivePath('/')}`> Home </a>
    <a id="about" href="/about/" class=`${setActivePath('/about/')}`> About </a>
    <a id="service" href="/services/" class=`${setActivePath('/services/')}`> Services </a>
    <a id="contact" href="/contact/" class=`${setActivePath('/contact/')}`> Contact </a>
    <a href="tel:(985)-626-5711" class="flex items-center text-red-800 text-[16px] font-bold font-[Golos_Text] ml-5 cursor-pointer w-[184px]"> 
        <div data-svg-wrapper class="mr-2.5">
            <svg width="26" height="26" viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8.85683 0.871252C10.8566 2.3295 12.3702 4.37834 13.6591 6.26092L14.6692 7.74609C14.9829 8.20456 15.1265 8.75828 15.075 9.31141C15.0235 9.86454 14.7803 10.3823 14.3874 10.775L12.2404 12.922L12.4668 13.4033C13.021 14.5259 13.9773 16.1425 15.4166 17.5833C16.412 18.5603 17.5321 19.4015 18.7479 20.085L19.329 20.3969L19.8467 20.6534L20.0779 20.7595L22.2233 18.6125C22.6173 18.2182 23.1374 17.975 23.6926 17.9255C24.2478 17.876 24.8027 18.0233 25.2602 18.3418L26.8657 19.4548C28.6897 20.7373 30.5944 22.1988 32.0748 24.0956C32.3307 24.4248 32.4935 24.8166 32.5462 25.2303C32.5988 25.6439 32.5394 26.064 32.3741 26.4468C31.0488 29.5391 27.6953 32.1722 24.2072 32.0423L23.7322 32.017L23.3633 31.9853L22.9548 31.9378L22.5099 31.8777L22.027 31.7969L21.5108 31.6956L20.963 31.5737L20.3835 31.4248L19.7739 31.2507L19.1374 31.0448C16.2146 30.0537 12.5048 28.1062 8.69849 24.2998C4.89216 20.4935 2.94624 16.7853 1.95508 13.8625L1.74924 13.226L1.57508 12.6164L1.42624 12.0369L1.30274 11.4891C1.26711 11.3175 1.23386 11.1454 1.20299 10.9729L1.12383 10.49L1.06049 10.0451L1.01458 9.63659L0.982909 9.26767L0.957576 8.79267C0.829326 5.31567 3.49091 1.93842 6.56891 0.619502C6.93937 0.459533 7.34506 0.398628 7.74617 0.442763C8.14727 0.486898 8.53001 0.634558 8.85683 0.871252ZM7.38908 3.73392C5.69174 4.62058 4.04824 6.64725 4.12266 8.6755L4.15433 9.19484L4.18916 9.51942L4.23508 9.88358L4.29841 10.2842L4.37916 10.7228L4.48208 11.1946L4.60874 11.7013L4.76074 12.238L4.94124 12.8048C5.00774 12.998 5.07846 13.1959 5.15341 13.3986L5.39724 14.0193L5.67591 14.6637C6.67024 16.8518 8.29158 19.4137 10.9405 22.061C13.5878 24.7083 16.1497 26.3313 18.3378 27.3256L18.9822 27.6043L19.6029 27.8481C19.8056 27.9241 20.0035 27.9948 20.1967 28.0603L20.7635 28.2408L21.3018 28.3928L21.8069 28.5194L22.2787 28.6223L22.7173 28.7031L23.1195 28.7664L23.4837 28.8139L23.8067 28.8456L24.326 28.8773C26.3273 28.9517 28.3698 27.3177 29.2533 25.6425C28.126 24.3204 26.7263 23.2358 25.1826 22.1433L23.9982 21.3184" fill="#8C1111"></path>
            </svg>
        </div>
        (985) 626-5711 
    </a>
</div>

<!-- Mobile Navigation Menu -->
<div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 right-0 bg-white shadow-lg z-50 border-t border-gray-200">
    <nav class="flex flex-col p-3 space-y-1">
        <a id="home-mobile" href="/" class=`${setActivePath('/')}`> Home </a>
        <a id="about-mobile" href="/about/" class=`${setActivePath('/about/')}`> About </a>
        <a id="service-mobile" href="/services/" class=`${setActivePath('/services/')}`> Services </a>
        <a id="contact-mobile" href="/contact/" class=`${setActivePath('/contact/')}`> Contact </a>
    </nav>
</div>

<script>
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        document.addEventListener('click', (e) => {
            const target = e.target as HTMLElement;
            if (!mobileMenu.contains(target) && !mobileMenuBtn.contains(target)) {
                mobileMenu.classList.add('hidden');
            }
        });
    }
</script>